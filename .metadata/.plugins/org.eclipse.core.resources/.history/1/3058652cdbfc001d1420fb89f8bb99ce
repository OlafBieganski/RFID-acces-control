#include "keypad.h"

void keypad_init(){
	for(uint8_t l_row = 0; l_row < NUM_OF_ROWS; l_row++)
		HAL_GPIO_WritePin(row_ports_array[l_row],
						  row_pins_array[l_row],
						  GPIO_PIN_SET);
}

int8_t keypad_scan_pressed_index(){
	for(uint8_t l_row = 0; l_row < NUM_OF_ROWS; l_row++){
		HAL_GPIO_WritePin(row_ports_array[l_row],
						  row_pins_array[l_row],
						  GPIO_PIN_RESET);
		for(uint8_t l_col = 0; l_col < NUM_OF_COLUMNS; l_col++){
			if(HAL_GPIO_ReadPin(column_ports_array[l_col],
								column_pins_array[l_col]) == GPIO_PIN_RESET){
				return (l_row * 3 + l_col);
			}
		}
	}
	return NO_BUTTON_PRESSED;
}

int8_t keypad_index_to_number(int8_t index){
	if(index > -1 && index < 9) return (index + 1);
	if(index == 10) 			return 0;
	return NO_BUTTON_PRESSED;
}
